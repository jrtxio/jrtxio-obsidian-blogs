---
{"dg-publish":true,"dg-path":"02 软件开发/IP 地址演进：从 IPv4 分类到 CIDR 与 IPv6.md","permalink":"/02 软件开发/IP 地址演进：从 IPv4 分类到 CIDR 与 IPv6/"}
---

#Ofilm #ETH

IP 地址是网络通信的基础标识。IPv4 采用 32 位地址，面临资源枯竭；IPv6 以 128 位地址提供近乎无限的扩展空间。本文系统阐述 IPv4 的传统分类、CIDR 的优化机制及 IPv6 的核心架构。

## 一、IPv4 地址的传统分类

早期 IPv4 按首位特征划分为五类：

| 类型  | 地址范围                            | 网络/主机位  | 用途             |
| --- | ------------------------------- | ------- | -------------- |
| A 类 | `1.0.0.0` ~ `126.255.255.255`   | 8/24 位  | 大型网络（1677 万主机） |
| B 类 | `128.0.0.0` ~ `191.255.255.255` | 16/16 位 | 中型网络（6.5 万主机）  |
| C 类 | `192.0.0.0` ~ `223.255.255.255` | 24/8 位  | 小型网络（254 主机）   |
| D 类 | `224.0.0.0` ~ `239.255.255.255` | —       | 多播通信           |
| E 类 | `240.0.0.0` ~ `255.255.255.255` | —       | 保留实验           |

> [!NOTE]
> `127.0.0.0/8` 为环回地址；`10.0.0.0/8`、`172.16.0.0/12`、`192.168.0.0/16` 为私有地址。

## 二、CIDR：解决地址浪费的核心机制

传统分类导致严重地址浪费（如 500 台主机需分配 B 类，浪费 6 万余地址）。**无类别域间路由（CIDR, Classless Inter-Domain Routing）** 引入前缀长度表示法，实现灵活分配。

### 1. 表示方法

格式：`网络地址/前缀长度`  
示例：
- `192.168.1.0/24`：前 24 位为网络号，等价于传统 C 类
- `10.10.0.0/16`：B 类大小
- `172.16.0.0/12`：覆盖全部 B 类私有地址

### 2. 子网划分与地址计算

- `/n` 表示前 n 位为网络部分，剩余 (32−n) 位为主机部分。
- 可用主机数：$2^{(32-n)} - 2$（减去网络地址与广播地址）

| CIDR | 主机位数 | 可用主机数 |
|------|---------|-----------|
| /24 | 8 | 254 |
| /23 | 9 | 510 |
| /25 | 7 | 126 |
| /30 | 2 | 2（常用于点对点链路） |

### 3. 核心优势

- ✅ **高效利用地址**：按需分配，避免浪费（如 500 台设备可用 `/23`）
- ✅ **支持 VLSM**（可变长子网掩码）：同一网络内可划分子网
- ✅ **路由聚合**：ISP 可将多个小网络聚合成大块（如 `192.168.0.0/21` 覆盖 8 个 /24），减少全球路由表条目

## 三、IPv6：下一代 IP 协议

为彻底解决 IPv4 枯竭问题，IPv6 采用 128 位地址，提供 $2^{128}$ 个地址（约 $3.4 \times 10^{38}$）。

### 1. 地址格式

- 128 位，8 组 16 位十六进制数，冒号分隔  
  示例：`2001:0db8:85a3:0000:0000:8a2e:0370:7334`
- 压缩规则：
  - 前导零可省：`2001:db8:85a3::8a2e:370:7334`
  - 连续全零组用 `::` 表示（仅一次）

### 2. 主要地址类型

| 类型 | 前缀 | 用途 |
|------|------|------|
| 全球单播 | `2000::/3` | 公网可路由地址 |
| 唯一本地地址（ULA） | `fc00::/7` | 私有网络通信 |
| 链路本地地址 | `fe80::/10` | 同链路通信，自动配置 |
| 组播 | `ff00::/8` | 一对多传输 |
| 任播 | 同单播格式 | 发往“最近”节点 |

### 3. 核心优势

- 更大地址空间，支持万物互联
- 原生支持自动配置（SLAAC）、IPSec 和扩展头
- 简化报头结构（固定 40 字节），提升转发效率

## 四、过渡机制与现状

IPv4 与 IPv6 长期共存，主要过渡技术包括：

- **双栈（Dual Stack）**：设备同时运行 IPv4 和 IPv6
- **隧道（Tunneling）**：IPv6 报文封装在 IPv4 中传输
- **NAT64/DNS64**：IPv6 客户端访问 IPv4 服务

目前全球 IPv6 普及率超 40%，广泛应用于 5G、物联网、云计算和车载网络。

## 总结

- **传统分类法**因僵化导致地址浪费，已被淘汰。
- **CIDR** 实现灵活寻址与高效路由，是现代 IPv4 网络的基石。
- **IPv6** 提供海量地址与先进特性，是未来网络的必然方向。

掌握从 IPv4 到 IPv6 的演进逻辑，是理解现代网络架构的关键。