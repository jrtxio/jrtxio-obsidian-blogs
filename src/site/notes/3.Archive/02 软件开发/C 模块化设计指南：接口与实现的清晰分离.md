---
{"dg-publish":true,"dg-path":"02 è½¯ä»¶å¼€å‘/C æ¨¡å—åŒ–è®¾è®¡æŒ‡å—ï¼šæ¥å£ä¸å®ç°çš„æ¸…æ™°åˆ†ç¦».md","permalink":"/02 è½¯ä»¶å¼€å‘/C æ¨¡å—åŒ–è®¾è®¡æŒ‡å—ï¼šæ¥å£ä¸å®ç°çš„æ¸…æ™°åˆ†ç¦»/","created":"2025-06-04T11:04:45.052+08:00","updated":"2025-10-14T13:57:20.650+08:00"}
---

#Innolight

åœ¨ C è¯­è¨€å¼€å‘ä¸­ï¼Œè‰¯å¥½çš„æ¨¡å—åŒ–è®¾è®¡æ˜¯æ„å»ºå¯ç»´æŠ¤ã€å¯å¤ç”¨ã€å¯æµ‹è¯•ä»£ç çš„åŸºç¡€ã€‚å…¶æ ¸å¿ƒåœ¨äºé€šè¿‡ `.h`ï¼ˆå¤´æ–‡ä»¶ï¼‰ä¸ `.c`ï¼ˆæºæ–‡ä»¶ï¼‰çš„åˆç†åˆ†å·¥ï¼Œå®ç°**æ¥å£ä¸å®ç°çš„åˆ†ç¦»**ã€‚æœ¬æ–‡ç³»ç»Ÿé˜è¿°æ¨¡å—åŒ–è®¾è®¡çš„åŸåˆ™ã€æ–‡ä»¶èŒè´£åˆ’åˆ†ä¸æœ€ä½³å®è·µã€‚

# ä¸€ã€è®¾è®¡åŸåˆ™

## 1. æ¥å£ä¸å®ç°åˆ†ç¦»

- `.h` æ–‡ä»¶å®šä¹‰**æ¨¡å—å¯¹å¤–æ¥å£**ï¼ˆwhatï¼‰ï¼Œä¾›å…¶ä»–æ¨¡å—è°ƒç”¨ã€‚
- `.c` æ–‡ä»¶å®ç°**å†…éƒ¨é€»è¾‘**ï¼ˆhowï¼‰ï¼Œå°è£…å…·ä½“ç»†èŠ‚ã€‚

## 2. ä¿¡æ¯éšè—ï¼ˆInformation Hidingï¼‰

- æ¨¡å—å†…éƒ¨ä½¿ç”¨çš„å‡½æ•°ã€å˜é‡åº”å£°æ˜ä¸º `static`ï¼Œé™åˆ¶ä½œç”¨åŸŸã€‚
- å¤–éƒ¨æ— éœ€äº†è§£å®ç°ï¼Œä»…é€šè¿‡æ¥å£äº¤äº’ã€‚

## 3. æœ€å°æš´éœ²åŸåˆ™

- å¤´æ–‡ä»¶ä»…æš´éœ²å¿…è¦æ¥å£ï¼Œå‡å°‘æ¨¡å—é—´è€¦åˆã€‚
- é¿å…å¤´æ–‡ä»¶åŒ…å«ä¸å¿…è¦çš„ä¾èµ–ã€‚

# äºŒã€å¤´æ–‡ä»¶ï¼ˆ`.h`ï¼‰ï¼šå£°æ˜æ¥å£

å¤´æ–‡ä»¶ç”¨äºå£°æ˜æ¨¡å—çš„å…¬å…±æ¥å£ï¼Œ**ä¸åŒ…å«å®ç°ä»£ç **ã€‚

## åº”åŒ…å«çš„å†…å®¹ï¼š

### 1. å‡½æ•°å£°æ˜

å¯¹å¤–æä¾›çš„æ¥å£å‡½æ•°åŸå‹ã€‚

```c
// example.h
#ifndef EXAMPLE_H
#define EXAMPLE_H

void log_message(const char *msg);
int buffer_write(const void *data, int len);

#endif
```

### 2. ç±»å‹å®šä¹‰

å…¬å…±ç»“æ„ä½“ã€æšä¸¾ã€è”åˆä½“ã€‚

```c
typedef struct {
    int id;
    char name[32];
} User;

enum LogLevel {
    LOG_INFO,
    LOG_WARN,
    LOG_ERROR
};
```

### 3. å®ä¸å¸¸é‡

å…¨å±€å¸¸é‡æˆ–åŠŸèƒ½æ€§å®ã€‚

```c
#define MAX_BUFFER_SIZE 1024
#define PI 3.1415926
```

### 4. å…¨å±€å˜é‡çš„ `extern` å£°æ˜

å˜é‡å®šä¹‰åœ¨ `.c` ä¸­ï¼Œå¤´æ–‡ä»¶ä»…å£°æ˜ã€‚

```c
extern int global_counter;
```

### 5. å†…è”å‡½æ•°ï¼ˆå¯é€‰ï¼‰

ç®€å•å‡½æ•°å¯å®šä¹‰ä¸º `static inline`ï¼Œæå‡æ€§èƒ½ã€‚

```c
static inline int max(int a, int b) {
    return a > b ? a : b;
}
```

## ä¸åº”åŒ…å«çš„å†…å®¹ï¼š

- å‡½æ•°å®ç°
- å˜é‡å®šä¹‰ï¼ˆé™¤ `static const`ï¼‰
- ç§æœ‰ç±»å‹æˆ–å®ç°ç»†èŠ‚
- `.c` æ–‡ä»¶çš„åŒ…å«

> **ç¦æ­¢**ï¼š`#include "example.c"` æˆ–åœ¨å¤´æ–‡ä»¶ä¸­å†™é€»è¾‘ä»£ç ã€‚

# ä¸‰ã€æºæ–‡ä»¶ï¼ˆ`.c`ï¼‰ï¼šå®ç°é€»è¾‘

æºæ–‡ä»¶è´Ÿè´£å®ç°å¤´æ–‡ä»¶ä¸­å£°æ˜çš„åŠŸèƒ½ï¼Œå¹¶å°è£…å†…éƒ¨ç»†èŠ‚ã€‚

## åº”åŒ…å«çš„å†…å®¹ï¼š

### 1. åŒ…å«å¯¹åº”å¤´æ–‡ä»¶

ç¡®ä¿å£°æ˜ä¸å®ç°ä¸€è‡´ã€‚

```c
// example.c
#include "example.h"
#include <stdio.h>
#include <string.h>
```

### 2. å‡½æ•°å®ç°

å®ç°å¤´æ–‡ä»¶ä¸­å£°æ˜çš„å‡½æ•°ã€‚

```c
int global_counter = 0;

void log_message(const char *msg) {
    printf("[LOG] %s\n", msg);
    global_counter++;
}
```

### 3. ç§æœ‰å‡½æ•°ä¸å˜é‡

ä½¿ç”¨ `static` é™å®šä½œç”¨åŸŸï¼Œå®ç°ä¿¡æ¯éšè—ã€‚

```c
static char buffer[MAX_BUFFER_SIZE];
static int buf_index = 0;

static void flush_buffer(void) {
    // ä»…æœ¬æ–‡ä»¶å¯ç”¨
    printf("Flush: %.*s\n", buf_index, buffer);
    buf_index = 0;
}
```

### 4. å…¨å±€å˜é‡å®šä¹‰

å¯¹åº”å¤´æ–‡ä»¶ä¸­çš„ `extern` å£°æ˜ã€‚

```c
int global_counter = 0;
```

# å››ã€åŒ…å«å…³ç³»ä¸ä¾èµ–ç®¡ç†

## 1. åŒ…å«è§„åˆ™

- **æ¯ä¸ª `.c` æ–‡ä»¶åº”åŒ…å«å…¶å¯¹åº”çš„ `.h` æ–‡ä»¶**ï¼šéªŒè¯æ¥å£ä¸€è‡´æ€§ã€‚
- **å…¶ä»–æ¨¡å—é€šè¿‡ `#include "module.h"` ä½¿ç”¨åŠŸèƒ½**ï¼Œä¸åŒ…å« `.c` æ–‡ä»¶ã€‚
- **å¤´æ–‡ä»¶ä¸­ä»…åŒ…å«å…¶ç›´æ¥ä¾èµ–çš„å¤´æ–‡ä»¶**ï¼Œé¿å…éšå¼ä¾èµ–ã€‚

## 2. é˜²æ­¢é‡å¤åŒ…å«

ä½¿ç”¨ **include guard** æˆ– `#pragma once`ï¼š

```c
// æ–¹å¼ä¸€ï¼šæ ‡å‡† include guardï¼ˆå…¼å®¹æ€§å¼ºï¼‰
#ifndef EXAMPLE_H
#define EXAMPLE_H
// å†…å®¹
#endif

// æ–¹å¼äºŒï¼šç°ä»£ç¼–è¯‘å™¨æ”¯æŒï¼ˆç®€æ´ï¼‰
#pragma once
// å†…å®¹
```

> âœ… æ¨èï¼šé¡¹ç›®ç»Ÿä¸€é£æ ¼ï¼Œå¤§å‹é¡¹ç›®å»ºè®®ä½¿ç”¨ `#ifndef`ã€‚

# äº”ã€å®Œæ•´ç¤ºä¾‹

## `logger.h`

```c
#ifndef LOGGER_H
#define LOGGER_H

extern int log_counter;

void log_info(const char *msg);
void log_error(const char *msg);

#endif
```

## `logger.c`

```c
#include "logger.h"
#include <stdio.h>

int log_counter = 0;

void log_info(const char *msg) {
    printf("[INFO] %s\n", msg);
    log_counter++;
}

void log_error(const char *msg) {
    printf("[ERROR] %s\n", msg);
    log_counter++;
}
```

## `main.c`

```c
#include "logger.h"
#include <stdio.h>

int main() {
    log_info("Application started");
    log_error("Failed to open file");
    printf("Total logs: %d\n", log_counter);
    return 0;
}
```

## ç¼–è¯‘ä¸è¿è¡Œ

```bash
# ç›´æ¥ç¼–è¯‘æ‰€æœ‰æºæ–‡ä»¶
gcc main.c logger.c -o app

# æˆ–åˆ†æ­¥ç¼–è¯‘åé“¾æ¥
gcc -c logger.c -o logger.o
gcc -c main.c -o main.o
gcc logger.o main.o -o app

./app
```

## è¾“å‡º

```
[INFO] Application started
[ERROR] Failed to open file
Total logs: 2
```

# å…­ã€æœ€ä½³å®è·µæ€»ç»“

| åŸåˆ™ | è¯´æ˜ |
|------|------|
| **`.h` æ–‡ä»¶åªå£°æ˜ï¼Œä¸å®ç°** | é¿å…é€»è¾‘åµŒå…¥å¤´æ–‡ä»¶ |
| **`.c` æ–‡ä»¶å®ç°å¹¶å°è£…** | ç§æœ‰å†…å®¹ç”¨ `static` ä¿®é¥° |
| **å¤´æ–‡ä»¶è‡ªåŒ…å«** | å•ç‹¬åŒ…å«å¤´æ–‡ä»¶åº”èƒ½é€šè¿‡ç¼–è¯‘ |
| **é¿å…å¾ªç¯ä¾èµ–** | æ¨¡å—é—´ä¾èµ–åº”ä¸ºæœ‰å‘æ— ç¯å›¾ï¼ˆDAGï¼‰ |
| **å‘½åæ¸…æ™°ä¸€è‡´** | `module.h` ä¸ `module.c` é…å¯¹ |
| **ä½¿ç”¨ include guard** | é˜²æ­¢å¤šé‡åŒ…å« |

# ç»“è¯­

C è¯­è¨€è™½æ— å†…ç½®æ¨¡å—ç³»ç»Ÿï¼Œä½†é€šè¿‡ `.h` ä¸ `.c` çš„è§„èŒƒä½¿ç”¨ï¼Œå¯å®ç°é«˜åº¦æ¨¡å—åŒ–çš„ä»£ç ç»“æ„ã€‚éµå¾ªâ€œæ¥å£ä¸å®ç°åˆ†ç¦»â€ã€â€œä¿¡æ¯éšè—â€å’Œâ€œæœ€å°æš´éœ²â€åŸåˆ™ï¼Œä¸ä»…èƒ½æå‡ä»£ç å¯è¯»æ€§ä¸å¯ç»´æŠ¤æ€§ï¼Œä¹Ÿä¸ºå›¢é˜Ÿåä½œå’Œé•¿æœŸæ¼”è¿›å¥ å®šåšå®åŸºç¡€ã€‚

> ğŸ“Œ **è®°ä½**ï¼šä¸€ä¸ªå¥½çš„æ¨¡å—ï¼Œåº”è¯¥åƒä¸€ä¸ªé»‘ç›’â€”â€”å¤–éƒ¨çŸ¥é“å¦‚ä½•ä½¿ç”¨å®ƒï¼Œä½†æ— éœ€å…³å¿ƒå®ƒå¦‚ä½•å·¥ä½œã€‚